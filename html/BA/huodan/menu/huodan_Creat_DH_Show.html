<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>展示新建订单类型</title>
		<link rel="stylesheet" type="text/css" href="../../../../css/api.css"/>
		<style>
			.goodmsg{ width: 100%; height: 45px; float: left; border-bottom: 1px solid #DDDDDD;}
			.goodmsg .kuai{ width: 5px; margin-right: 10px; height: 15px; margin-top: 15px; float: left; background-color: #FF0000; margin-left: 10px;}
			.goodmsg{ line-height: 45px; font-size: 14px;}
			.goodmsg .kuai1{ background-color: #71C4E4;}
			.goodmsg .jiahao666{ width: 20px; padding: 10px; height: 20px; float: right; margin-right: 10px;}
			.info{ width: 100%; height: auto; float: left;}
			.info ul{ width: 100%; height: auto; float: left;}
			.info ul li{ width: 90%; margin-left: 5%; margin-right: 5%; height: auto; float: left; border-bottom: 1px solid #f5f5f5;}
			.info ul li .leftitem{ width: 80px; height: auto; line-height: 40px; float: left; text-align: center;}
			.info ul li .rightitem{ width: auto; line-height: 20px; float: left; margin-top: 10px; margin-left: 5px;}

			.goodinfo{ width: 100%; height: auto; float: left; margin-bottom: 50px;}
			.goodinfo ul{ width: 100%; height: auto; float: left;}
			.goodinfo ul li{ padding: 5px 0; margin-top: 5px; border-radius: 5px; width: 94%; margin-left: 3%; margin-right: 3%; height: auto; float: left; background-color: #f5f5f5;}
			.goodinfo ul li .name{ width: 90%; height: auto; float: left; margin-left: 5%; margin-right: 5%;}
			.goodinfo ul li .name .left{ font-size: 14px; width: 80px; height: 25px; line-height: 25px; float: left; font-style: normal;}
			.goodinfo ul li .name .right{ color: #666; width: auto; height: auto; line-height: 25px; float: left; font-style: normal;}
			.goodinfo ul li .imglist{ width: 90%; height: auto; float: left; margin-left: 5%; margin-right: 5%;}
			.goodinfo ul li .imglist img{ width: 50px; height: 50px; float: left; margin: 5px 4px 5px 0;}
			.goodinfo ul li .inputnum{ width: 90%; margin-left: 5%; margin-right: 5%; float: left;}
			.goodinfo ul li .inputnum .editname{ width: 80px; line-height: 25px; height: 25px; float: left; font-size: 14px;}
			.goodinfo ul li .inputnum .editnum{ margin-bottom: 5px; width: 100px; height: 25px; float: left; background-color: #FFFFFF;}
			.goodinfo ul li .inputnum .editnum input{ width: 90px; margin-left: 5px; margin-right: 5px; float: left; outline: none; height: 20px; line-height: 20px; margin-top: 2.5px; text-align: center; }

			.bottom{ width: 100%; height: 50px; bottom: 0; left: 0; position: fixed; background-color: #f5f5f5; border-top: 1px solid #CCCCCC;}
			.bottom .one{ width: 35%; height: 35px; border-radius: 17.5px; line-height: 35px; font-size: 14px; margin-top: 7.5px; margin-left: 7.5%; margin-right: 7.5%; float: left; text-align: center; background-color: #FF5C01; color: #FFFFFF;}
			.bottom .two{ width: 35%; height: 35px; border-radius: 17.5px; line-height: 35px; font-size: 14px; margin-top: 7.5px; margin-left: 7.5%; margin-right: 7.5%; float: left; text-align: center; background-color: #71C4E4; color: #FFFFFF;}
		</style>
	</head>
	<body>
		<div class="goodmsg"><i class="kuai"></i>订单信息</div>
		<div class="info">
			<ul id="goodinfo">
				<!--<li>
					<span class="leftitem">左边文字</span>
					<span class="rightitem">右边文字</span>
				</li>-->
			</ul>
		</div>
		<div class="goodmsg"><i class="kuai kuai1"></i>商品信息
			<!--<img class="jiahao666" src="../../../../image/jiahao666.png" />-->
		</div>
		<div class="goodinfo">
			<ul id="shangpinlist">
				<!--<li>
					<span class="name"><i class="left">商品名称:</i><i class="right">商品名称商品名称商品名称商品名称</i></span>
					<span class="name"><i class="left">商品编号:</i><i class="right">RRRRRRRRRRRRRRR</i></span>
					<span class="name"><i class="left">申请数量:</i><i class="right">RRRRRRRRRRRRRRR</i></span>
					<div class="inputnum">
						<span class="editname">申请数量:</span>
						<div class="editnum">
							<input />
						</div>
					</div>
					<div class="inputnum">
						<span class="editname">申请数量:</span>
						<div class="editnum">
							<input />
						</div>
					</div>
					<div class="imglist">
						<img />
						<img />
						<img />
						<img />
						<img />
					</div>
				</li>-->
			</ul>
		</div>

		<div class="bottom">
			<span onclick="api.closeWin();" class="one">返回编辑</span>
			<span onclick="tijiao_danzi()" class="two">确定提交</span>
		</div>
	</body>
	<script type="text/javascript" src="../../../../script/api.js"></script>
	<script type="text/javascript" src="../../../../script/apiclear.js"></script>
	<script type="text/javascript" src="../../../../script/log.js"></script>
	<script type="text/javascript" src="../../../../script/kunchiba.js"></script>
	<script type="text/javascript" src="../../../../script/kunchisale.js"></script>
	<script type="text/javascript">



		apiready = function() {
			initxml();
		};

		function initxml(){
			var tijiaohuodan = $api.getStorage("tijiaohuodan");
			var goodinfo = document.getElementById("goodinfo");
			var html = '<li><span class="leftitem">收货人:</span><span class="rightitem">'+tijiaohuodan._Order.cSignName+'</span></li>';
			$api.append(goodinfo, html);
			var html = '<li><span class="leftitem">联系电话:</span><span class="rightitem">'+tijiaohuodan._Order.cSignTele+'</span></li>';
			$api.append(goodinfo, html);
			var html = '<li><span class="leftitem">收货地址:</span><span class="rightitem">'+tijiaohuodan._Order.cSignAddress+'</span></li>';
			$api.append(goodinfo, html);


			var shangpinlist = document.getElementById("shangpinlist");
			for(var a = 0; a < tijiaohuodan._Order.T_OrderDetail.length; a++){
				var html = '<li>'
					+			'<span class="name"><i class="left">商品名称:</i><i class="right">'+tijiaohuodan._Order.T_OrderDetail[a].goodname+'</i></span>'
					+			'<span class="name"><i class="left">商品编号:</i><i class="right">'+tijiaohuodan._Order.T_OrderDetail[a].goodcode+'</i></span>'
					+			'<span class="name"><i class="left">可申请数量:</i><i class="right">'+tijiaohuodan._Order.T_OrderDetail[a].totalnum+'</i></span>'
					+			'<div class="inputnum">'
					+				'<span class="editname">申请数量:</span>'
					+				'<div class="editnum">'
					+					'<input readonly="readonly" value="'+tijiaohuodan._Order.T_OrderDetail[a].iCount+'" />'
					+				'</div>'
					+			'</div>'
					+			'<div class="inputnum">'
					+				'<span class="editname">商品单价:</span>'
					+				'<div class="editnum">'
					+					'<input readonly="readonly" value="'+tijiaohuodan._Order.T_OrderDetail[a].iPrice+'" />'
					+				'</div>'
					+			'</div>'
					+		'</li>';
				$api.append(shangpinlist, html);
			}
		}

		function tijiao_danzi(){
			jiazai();
			var json = $api.getStorage("tijiaohuodan");
			var url = "ActionApi/T_Orders/PostT_Orders";

			if(isempty(json._Order.iDirectorId)){
				url = "ActionApi/T_Orders/T_OrdersSalesOut";//不需要审核
			}
			//console.log(url);
			//console.log(JSON.stringify(json));
			$kunchi.kunchipost(url, json, function(ret, err) {
				//console.log(JSON.stringify(ret) + "+++" + JSON.stringify(err));
				tingzhi();
				if(ret){
					api.alert({
					    title: '提示',
					    msg: '提交成功',
					}, function(aaa, bbb) {
						api.sendEvent({
		                    name:'updatehuodan'
	                    });
	                    setTimeout("guanbiyemian()",300);
					});
				}else{
					alert("网络错误,稍后重试.");
				}
			});
		}

		function guanbiyemian(){
			api.closeToWin({
                name: 'jinhuolist'
            });
		}



	</script>
</html>
